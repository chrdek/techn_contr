${Get-PublicKeyDlls-LG1.ps1} = {function Get-PKTokenwithManifest{param([switch]$legacyNET)if($legacyNET){New-PSDrive -Name "GACDrive" -Root "$env:windir\assembly" -PSProvider "FileSystem";cd GACDrive:;Get-ChildItem -Path .\*.dll -Recurse|% {([System.Reflection.Assembly]::LoadWithPartialName($_.BaseName).FullName);([System.Reflection.Assembly]::LoadWithPartialName($_.BaseName).ManifestModule);[System.Reflection.Assembly]::LoadFile($_.FullName).GetReferencedAssemblies()|Select Name,Version}};New-PSDrive -Name "DotNetGACDrive" -Root "$env:windir\Microsoft.NET\assembly" -PSProvider "FileSystem";cd DotNetGACDrive:;Get-ChildItem -Path .\*\*.dll -Recurse|% {([System.Reflection.Assembly]::LoadWithPartialName($_.BaseName).FullName);([System.Reflection.Assembly]::LoadWithPartialName($_.BaseName).ManifestModule);[System.Reflection.Assembly]::LoadFile($_.FullName).GetReferencedAssemblies()|Select Name,Version};cd $env:USERPROFILE\Documents\};Get-PKTokenwithManifest}
