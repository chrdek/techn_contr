${Fmt-Create-LG1.ps1} = {function Get-FmtFile{param([string]$DBServName,[string]$DBName,[string]$TableName)if(-not(Test-Path "$env:USERPROFILE\Documents\$TableName-layout.fmt")){$DBServName="$([System.Environment]::MachineName)\{0}"-f$DBServName;$DBSel="{0}.dbo.{1}"-f$DBName,$TableName;$args=@("$DBSel format nul","-c -f $env:USERPROFILE\Documents\$TableName-layout.fmt -t, -S $DBServName -T");Start-Process -FilePath "bcp" -ArgumentList $args -WindowStyle Hidden;Write-Host "BCP import file generated OK.."}else{Write-Host "File already exists, run the script with different args.."}};Get-FmtFile -DBServName "YourLocalServerInstanceName" -DBName "YourDBName" -TableName "YourTableName"}
